@{
    Layout = "/Pages/Shared/_Layout.cshtml";
}
<div class="flex min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors">
    <div id="manage-sidebar-overlay" class="fixed inset-0 bg-black/50 z-[18] lg:hidden hidden transition-opacity" aria-hidden="true"></div>
    <aside id="manage-sidebar" class="fixed left-0 top-14 md:top-16 lg:top-14 xl:top-16 z-20 h-[calc(100vh-3.5rem)] md:h-[calc(100vh-4rem)] lg:h-[calc(100vh-3.5rem)] xl:h-[calc(100vh-4rem)] w-72 max-w-[85vw] bg-slate-100 dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col transition-[transform,width] duration-300 ease-out -translate-x-full lg:translate-x-0" aria-label="Menú de cuenta">
        <div class="p-4 flex items-center justify-between gap-2 border-b border-slate-200 dark:border-slate-700">
            <a asp-page="./Index" class="flex items-center gap-3 min-w-0">
                <div class="w-10 h-10 bg-ritweb-teal rounded-lg flex items-center justify-center text-white font-bold text-xl flex-shrink-0">G</div>
                <div class="min-w-0 sidebar-logo-text">
                    <h1 class="font-bold text-lg leading-tight tracking-tight text-slate-800 dark:text-slate-100 truncate">Mi cuenta</h1>
                    <p class="text-[10px] uppercase tracking-widest text-slate-500 dark:text-slate-400 font-semibold">GPR</p>
                </div>
            </a>
            <button type="button" id="manage-sidebar-toggle" class="hidden lg:block p-2 rounded-md text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 hover:text-slate-700 dark:hover:text-slate-200 transition-colors flex-shrink-0" aria-label="Minimizar o expandir menú">
                <span class="material-icons manage-sidebar-icon-expand">chevron_left</span>
                <span class="material-icons manage-sidebar-icon-collapse hidden">chevron_right</span>
            </button>
            <button type="button" id="manage-sidebar-close-mobile" class="lg:hidden p-2 rounded-md text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700" aria-label="Cerrar menú">
                <span class="material-icons">close</span>
            </button>
        </div>
        <partial name="_ManageNav" />
    </aside>
    <main id="manage-main-content" class="flex-1 w-full min-w-0 ml-0 lg:ml-72 p-4 sm:p-6 lg:p-8 xl:p-12 transition-[margin] duration-300 ease-out min-h-screen">
        <div class="lg:hidden flex items-center justify-between gap-2 mb-4 pb-3 border-b border-slate-200 dark:border-slate-700">
            <button type="button" id="manage-sidebar-open-mobile" class="flex items-center gap-2 px-3 py-2 rounded-lg bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors" aria-label="Abrir menú">
                <span class="material-icons">menu</span>
                <span class="text-sm font-medium">Menú</span>
            </button>
            <span class="text-sm font-semibold text-slate-700 dark:text-slate-200 truncate">Mi cuenta</span>
        </div>
        @RenderBody()
    </main>
</div>
<style>
    #manage-sidebar.sidebar-collapsed nav a { justify-content: center; padding-left: 0; padding-right: 0; }
    #manage-sidebar.sidebar-collapsed .px-4 { padding-left: 0.5rem; padding-right: 0.5rem; }
</style>
<script>
(function () {
    var STORAGE_KEY = 'manage-sidebar-collapsed';
    var sidebar = document.getElementById('manage-sidebar');
    var main = document.getElementById('manage-main-content');
    var overlay = document.getElementById('manage-sidebar-overlay');
    var toggle = document.getElementById('manage-sidebar-toggle');
    var openMobile = document.getElementById('manage-sidebar-open-mobile');
    var closeMobile = document.getElementById('manage-sidebar-close-mobile');
    var iconExpand = document.querySelector('.manage-sidebar-icon-expand');
    var iconCollapse = document.querySelector('.manage-sidebar-icon-collapse');
    var labels = sidebar ? sidebar.querySelectorAll('.sidebar-label') : [];
    var texts = sidebar ? sidebar.querySelectorAll('.sidebar-text') : [];
    var logoTexts = sidebar ? sidebar.querySelectorAll('.sidebar-logo-text') : [];

    function isCollapsed() { return localStorage.getItem(STORAGE_KEY) === '1'; }
    function isMobile() { return window.innerWidth < 1024; }

    function closeMobileSidebar() {
        if (!sidebar || !overlay) return;
        sidebar.classList.add('-translate-x-full');
        sidebar.classList.remove('translate-x-0');
        overlay.classList.add('hidden');
    }
    function openMobileSidebar() {
        if (!sidebar || !overlay) return;
        sidebar.classList.remove('-translate-x-full');
        sidebar.classList.add('translate-x-0');
        overlay.classList.remove('hidden');
    }

    if (openMobile) openMobile.addEventListener('click', openMobileSidebar);
    if (closeMobile) closeMobile.addEventListener('click', closeMobileSidebar);
    if (overlay) overlay.addEventListener('click', closeMobileSidebar);
    window.addEventListener('resize', function () { if (!isMobile()) closeMobileSidebar(); });

    function applyState(collapsed) {
        if (isMobile()) return;
        if (collapsed) {
            sidebar.classList.add('sidebar-collapsed', 'w-20');
            sidebar.classList.remove('w-72');
            main.classList.remove('lg:ml-72');
            main.style.marginLeft = '5rem'; /* w-20 */
            if (iconExpand) iconExpand.classList.add('hidden');
            if (iconCollapse) iconCollapse.classList.remove('hidden');
            labels.forEach(function (el) { el.classList.add('hidden'); });
            texts.forEach(function (el) { el.classList.add('hidden'); });
            logoTexts.forEach(function (el) { el.classList.add('hidden'); });
        } else {
            sidebar.classList.remove('sidebar-collapsed', 'w-20');
            sidebar.classList.add('w-72');
            main.classList.add('lg:ml-72');
            main.style.marginLeft = '';
            if (iconExpand) iconExpand.classList.remove('hidden');
            if (iconCollapse) iconCollapse.classList.add('hidden');
            labels.forEach(function (el) { el.classList.remove('hidden'); });
            texts.forEach(function (el) { el.classList.remove('hidden'); });
            logoTexts.forEach(function (el) { el.classList.remove('hidden'); });
        }
    }

    if (toggle && sidebar && main) {
        if (!isMobile()) applyState(isCollapsed());
        toggle.addEventListener('click', function () {
            if (isMobile()) return;
            var collapsed = !isCollapsed();
            localStorage.setItem(STORAGE_KEY, collapsed ? '1' : '0');
            applyState(collapsed);
        });
    }
})();
</script>
@await RenderSectionAsync("Scripts", required: false)
